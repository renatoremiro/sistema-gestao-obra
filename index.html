<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gest√£o Completo - Obra 292 (Firebase v5.1)</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="assets/css/variables.css">
    <link rel="stylesheet" href="assets/css/layout.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/calendar.css">
    <link rel="stylesheet" href="assets/css/animations.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    
    <!-- CSS TEMPOR√ÅRIO PARA RESOLVER PROBLEMAS IMEDIATOS -->
    <style>
        /* Reset b√°sico */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f3f4f6;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Sistema de Login */
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .login-container h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #1f2937;
        }
        
        /* Cards */
        .card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 24px;
        }
        
        /* Header */
        .header {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }
        
        /* Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }
        
        /* Bot√µes */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            text-decoration: none;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn-primary { background: #3b82f6; color: white; }
        .btn-success { background: #10b981; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-secondary { background: #6b7280; color: white; }
        .btn-warning { background: #f59e0b; color: white; }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        
        /* Formul√°rios */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        /* Modais */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            padding: 32px;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        /* Status e indicadores */
        .sync-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
            transition: all 0.3s;
        }
        
        .sync-indicator.synced {
            background: #10b981;
            color: white;
        }
        
        .sync-indicator.syncing {
            background: #fbbf24;
        }
        
        .sync-indicator.error {
            background: #ef4444;
            color: white;
        }
        
        .sync-indicator.offline {
            background: #6b7280;
            color: white;
        }
        
        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        
        .resumo-numero {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .progress-fill {
            height: 100%;
            background: #3b82f6;
            transition: width 0.3s;
        }
        
        /* Calend√°rio b√°sico */
        .calendario {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-top: 20px;
        }
        
        .dia {
            background: white;
            border: 1px solid #e5e7eb;
            padding: 8px;
            min-height: 100px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: visible;
        }
        
        .dia:hover {
            border-color: #3b82f6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .dia-header {
            background: #1f2937;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            border-radius: 8px;
        }
        
        .dia-numero {
            font-weight: bold;
            margin-bottom: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dia-feriado {
            background: #fef3c7;
            border-color: #f59e0b;
        }
        
        .feriado-label {
            font-size: 10px;
            background: #f59e0b;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .hoje {
            background: #dbeafe;
            border-color: #3b82f6;
            font-weight: bold;
        }
        
        .outro-mes {
            background: #f9fafb;
            color: #9ca3af;
        }
        
        /* Eventos no calend√°rio */
        .evento {
            background: #3b82f6;
            color: white;
            padding: 4px 6px;
            border-radius: 4px;
            margin-top: 4px;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 2px;
            position: relative;
            transition: all 0.2s;
            user-select: none;
        }
        
        .evento:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
        }
        
        .evento-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 4px;
        }
        
        .evento-info {
            font-size: 9px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .evento-duracao {
            font-size: 9px;
            opacity: 0.8;
            margin-top: 2px;
        }
        
        .evento-reuniao { background: #3b82f6; }
        .evento-entrega { background: #10b981; }
        .evento-prazo { background: #ef4444; }
        .evento-marco { background: #8b5cf6; }
        .evento-outro { background: #6b7280; }
        
        .evento-dia-completo {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            margin: 2px -4px;
            padding: 6px 8px;
        }
        
        .evento-multi-dia {
            border-left: 3px solid #1e40af;
            background: linear-gradient(to right, #3b82f6, #60a5fa);
        }
        
        .recorrente-indicator {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            opacity: 0.8;
        }
        
        .delete-btn {
            position: absolute;
            top: 2px;
            right: 2px;
            background: rgba(239, 68, 68, 0.8);
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .evento:hover .delete-btn {
            opacity: 1;
        }
        
        .delete-btn:hover {
            background: #dc2626;
        }
        
        /* Timeline de eventos */
        .timeline-container {
            margin-top: 24px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .timeline-item {
            position: relative;
            padding-left: 32px;
            margin-bottom: 24px;
            border-left: 2px solid #e5e7eb;
        }
        
        .timeline-item:last-child {
            border-left: none;
        }
        
        .timeline-marker {
            position: absolute;
            left: -8px;
            top: 0;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            border: 3px solid #3b82f6;
        }
        
        .timeline-content {
            background: #f9fafb;
            padding: 12px;
            border-radius: 8px;
        }
        
        /* Configura√ß√µes de recorr√™ncia */
        .recorrencia-config {
            background: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            margin-top: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .checkbox-group {
            display: flex;
            gap: 16px;
            margin-top: 8px;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
            cursor: pointer;
        }
        
        /* Hor√°rios */
        .horario-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .horario-group .form-group {
            margin-bottom: 0;
        }
        
        /* Pessoas e tarefas selecionadas */
        .pessoas-selecionadas,
        .tarefas-vinculadas {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
            min-height: 40px;
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background: #f9fafb;
        }
        
        .pessoa-chip,
        .tarefa-chip {
            background: #e5e7eb;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .pessoa-chip .remove,
        .tarefa-chip .remove {
            cursor: pointer;
            color: #6b7280;
            font-weight: bold;
        }
        
        .pessoa-chip .remove:hover,
        .tarefa-chip .remove:hover {
            color: #ef4444;
        }
        
        .lista-vazia {
            color: #9ca3af;
            font-style: italic;
            font-size: 13px;
            padding: 8px;
        }
        
        /* Responsivo b√°sico */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .calendario {
                grid-template-columns: repeat(7, 1fr);
                gap: 4px;
            }
            
            .dia {
                min-height: 60px;
                padding: 4px;
                font-size: 12px;
            }
            
            .header {
                flex-direction: column;
                text-align: center;
            }
        }
        
        /* Notifica√ß√µes */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 2000;
        }
        
        .notification.active {
            display: flex;
        }
        
        .notification.error {
            background: #ef4444;
        }
        
        .notification.warning {
            background: #f59e0b;
        }
        
        /* Breadcrumb */
        .breadcrumb {
            background: #e5e7eb;
            padding: 8px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }
        
        .breadcrumb a {
            color: #3b82f6;
            text-decoration: none;
            cursor: pointer;
        }
        
        /* Log de atividades */
        .activity-log {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            max-height: 400px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
            transform: translateX(320px);
            transition: transform 0.3s;
            z-index: 900;
        }
        
        .activity-log.active {
            transform: translateX(0);
        }
        
        .activity-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #3b82f6;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 899;
        }
        
        /* Filtros */
        .search-box {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .search-box input {
            flex: 1;
            padding: 10px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
        }
        
        .filter-pills {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        .filter-pill {
            padding: 6px 16px;
            border-radius: 20px;
            background: #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }
        
        .filter-pill.active {
            background: #3b82f6;
            color: white;
        }
        
        /* Status indicators */
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-verde { background: #10b981; }
        .status-amarelo { background: #f59e0b; }
        .status-vermelho { background: #ef4444; }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginScreen" class="login-container">
        <h2>üèóÔ∏è Sistema de Gest√£o</h2>
        <p style="text-align: center; color: #6b7280; margin-bottom: 24px;">Obra 292 - Museu Nacional</p>
        
        <div class="form-group">
            <label>Email</label>
            <input type="email" id="loginEmail" placeholder="seu@email.com">
        </div>
        
        <div class="form-group">
            <label>Senha</label>
            <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        </div>
        
        <button class="btn btn-primary" style="width: 100%;" onclick="fazerLogin()">
            Entrar
        </button>
        
        <div style="margin-top: 16px; text-align: center;">
            <a href="#" onclick="mostrarRegistro()" style="color: #3b82f6; text-decoration: none;">
                N√£o tem conta? Registre-se
            </a>
        </div>
    </div>
    
    <!-- Indicador de Sincroniza√ß√£o -->
    <div id="syncIndicator" class="sync-indicator synced">
        <span class="loading" id="syncLoader" style="display: none;"></span>
        <span id="syncText">‚úì Sincronizado</span>
    </div>
    
    <!-- Indicador de Usu√°rios Online -->
    <div id="usersOnline" class="users-online hidden">
        <div style="font-size: 13px; color: #6b7280;">Equipe Online</div>
        <div class="users-online-list" id="usersOnlineList"></div>
    </div>
    
    <!-- Log de Atividades -->
    <div class="activity-toggle" onclick="toggleActivityLog()">
        üìã Atividades
    </div>
    
    <div id="activityLog" class="activity-log">
        <div class="activity-log-header">
            <span>Atividades Recentes</span>
            <span style="cursor: pointer;" onclick="toggleActivityLog()">‚úï</span>
        </div>
        <div class="activity-log-content" id="activityLogContent">
            <!-- Atividades ser√£o inseridas aqui -->
        </div>
    </div>
    
    <!-- Modal de Conflito -->
    <div id="conflictModal" class="conflict-modal">
        <h3>‚ö†Ô∏è Conflito de Edi√ß√£o</h3>
        <p id="conflictMessage"></p>
        <div class="conflict-options">
            <button class="btn btn-primary" onclick="resolverConflito('manter')">
                Manter Minhas Altera√ß√µes
            </button>
            <button class="btn btn-secondary" onclick="resolverConflito('descartar')">
                Usar Vers√£o do Servidor
            </button>
        </div>
    </div>
    
    <!-- Sistema de Notifica√ß√µes -->
    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>
    
    <div class="container" id="mainContainer" class="hidden">
        <!-- Breadcrumb de Navega√ß√£o -->
        <div id="breadcrumb" class="breadcrumb hidden">
            <span id="breadcrumbPath"></span>
        </div>
        
        <div class="header">
            <div>
                <h1>Sistema de Gest√£o Colaborativo</h1>
                <p>Obra 292 - Museu Nacional</p>
                <p style="font-size: 14px; color: #6b7280;">
                    Sistema v5.1 Firebase - Melhorias Avan√ßadas üöÄ
                    <span id="usuarioInfo" style="margin-left: 16px; font-weight: bold;"></span>
                </p>
            </div>
            <div style="text-align: right;">
                <p id="dataAtual" style="color: #6b7280;"></p>
                <p style="font-weight: bold;">
                    <span id="mesAno">Julho 2025</span>
                </p>
                <div style="margin-top: 8px;">
                    <button class="btn btn-success btn-sm" onclick="exportarDados()">
                        üì• Exportar
                    </button>
                    <button class="btn btn-primary btn-sm" onclick="mostrarImportar()">
                        üì§ Importar
                    </button>
                    <button class="btn btn-warning btn-sm" onclick="mostrarMarcarFeriado()">
                        üéâ Feriados
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="fazerLogout()">
                        üö™ Sair
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Dashboard Executivo -->
        <div id="dashboardExecutivo">
            <!-- Estat√≠sticas R√°pidas -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="resumo-numero" style="color: #10b981;" id="statEmDia">0</div>
                    <div>Em Dia</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressEmDia" style="background: #10b981;"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="resumo-numero" style="color: #f59e0b;" id="statAtencao">0</div>
                    <div>Aten√ß√£o</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressAtencao" style="background: #f59e0b;"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="resumo-numero" style="color: #ef4444;" id="statAtraso">0</div>
                    <div>Atraso</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressAtraso" style="background: #ef4444;"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="resumo-numero" style="color: #8b5cf6;" id="statEventos">0</div>
                    <div>Eventos no M√™s</div>
                </div>
            </div>
            
            <!-- Calend√°rio -->
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>üìÖ Calend√°rio da Equipe</h3>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-secondary btn-sm" onclick="mudarMes(-1)">‚óÄ Anterior</button>
                        <button class="btn btn-primary btn-sm" onclick="mostrarNovoEvento()">+ Novo Evento</button>
                        <button class="btn btn-secondary btn-sm" onclick="mudarMes(1)">Pr√≥ximo ‚ñ∂</button>
                    </div>
                </div>
                
                <div id="calendario" class="calendario"></div>
                
                <div style="margin-top: 16px; display: flex; gap: 16px; flex-wrap: wrap; font-size: 12px;">
                    <span><span class="status-indicator evento-reuniao"></span>Reuni√£o</span>
                    <span><span class="status-indicator evento-entrega"></span>Entrega</span>
                    <span><span class="status-indicator evento-prazo"></span>Prazo</span>
                    <span><span class="status-indicator evento-marco"></span>Marco</span>
                    <span><span class="status-indicator evento-outro"></span>Outros</span>
                    <span><span class="status-indicator" style="background: #f59e0b;"></span>Feriado</span>
                    <span>üîÑ Evento Recorrente</span>
                </div>
            </div>
            
            <!-- Timeline de Pr√≥ximos Eventos -->
            <div class="timeline-container">
                <h3 style="margin-bottom: 20px;">üìç Pr√≥ximos Eventos Importantes</h3>
                <div id="timelineEventos"></div>
            </div>
            
            <!-- Busca e Filtros -->
            <div class="card">
                <h3 style="margin-bottom: 16px;">üîç Busca e Filtros</h3>
                <div class="search-box">
                    <input type="text" placeholder="Buscar atividades, pessoas, eventos..." id="searchInput" onkeyup="buscarGlobalDebounced()">
                    <button class="btn btn-primary" onclick="buscarGlobal()">Buscar</button>
                </div>
                <div class="filter-pills">
                    <div class="filter-pill active" onclick="filtrarStatus('todos', this)">Todos</div>
                    <div class="filter-pill" onclick="filtrarStatus('verde', this)">Em Dia</div>
                    <div class="filter-pill" onclick="filtrarStatus('amarelo', this)">Aten√ß√£o</div>
                    <div class="filter-pill" onclick="filtrarStatus('vermelho', this)">Atraso</div>
                </div>
            </div>
            
            <!-- Dica do sistema -->
            <div style="background: #dbeafe; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; color: #1e40af;">
                <strong>üî• Sistema v5.1 - Novas Funcionalidades:</strong> 
                <br><strong>‚úÖ Edi√ß√£o Completa de Tarefas:</strong> Agora voc√™ pode editar descri√ß√£o, prioridade e depend√™ncias
                <br><strong>‚ö†Ô∏è Valida√ß√£o de Prazos:</strong> Sistema bloqueia cria√ß√£o de atividades com prazo no passado
                <br><strong>üìä Progresso Autom√°tico:</strong> Calculado automaticamente baseado nas tarefas conclu√≠das
                <br><strong>üîî Alertas Inteligentes:</strong> Notifica√ß√µes autom√°ticas para prazos vencendo
                <br><strong>‚è∞ Monitoramento 24/7:</strong> Sistema verifica automaticamente status das atividades
                <br><strong>üì± Ainda mais responsivo:</strong> Funciona perfeitamente em qualquer dispositivo!
            </div>
            
            <!-- Cards das √Åreas -->
            <div class="grid" id="areasGrid"></div>
        </div>
        
        <!-- Painel de √Årea -->
        <div id="painelArea" class="hidden">
            <span class="back-btn" onclick="voltarDashboard()">‚Üê Voltar ao Dashboard</span>
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 id="areaNome">Nome da √Årea</h2>
                        <p id="areaCoordenador" style="color: #6b7280;">Coordenador</p>
                    </div>
                    <button class="btn btn-primary" onclick="mostrarNovaAtividade()">+ Nova Atividade</button>
                </div>
            </div>
            
            <div class="grid">
                <div class="card">
                    <h3>üë• Equipe</h3>
                    <div id="equipeLista"></div>
                </div>
                
                <div class="card">
                    <h3>üìã Atividades em Andamento</h3>
                    <div id="atividadesLista"></div>
                </div>
            </div>
        </div>
        
        <!-- Agenda Individual -->
        <div id="agendaIndividual" class="hidden">
            <span class="back-btn" onclick="voltarParaArea()">‚Üê Voltar para √Årea</span>
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 id="pessoaNome">Nome da Pessoa</h2>
                        <p id="pessoaCargo" style="color: #6b7280;">Cargo</p>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-primary" onclick="mostrarNovaTarefa()">+ Nova Tarefa</button>
                        <button class="btn btn-warning btn-sm" onclick="mostrarMarcarStatus()">üìç Status Di√°rio</button>
                    </div>
                </div>
            </div>
            
            <div class="grid">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3>üìä Minhas Responsabilidades</h3>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <span id="contadorResponsabilidades" style="background: #e5e7eb; padding: 4px 12px; border-radius: 20px; font-size: 14px;">0</span>
                            <button class="btn btn-success btn-sm" onclick="mostrarAdicionarResponsabilidade()" title="Buscar novas responsabilidades">
                                + Adicionar
                            </button>
                        </div>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <select id="filtroResponsabilidades" onchange="renderizarResponsabilidades(estadoSistema.pessoaAtual)" 
                                style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 13px;">
                            <option value="todas">üîç Todas as responsabilidades</option>
                            <option value="urgentes">‚ö° Urgentes (‚â§ 3 dias)</option>
                            <option value="emdia">‚úÖ Em dia</option>
                            <option value="atencao">‚ö†Ô∏è Aten√ß√£o</option>
                            <option value="atrasadas">‚ùå Atrasadas</option>
                        </select>
                    </div>
                    <div id="responsabilidadesLista"></div>
                </div>
                
                <div class="card">
                    <h3>üìÖ Agenda da Semana</h3>
                    <div class="agenda-semana" id="agendaSemana"></div>
                </div>
            </div>
            
            <div class="card">
                <h3>üìù Observa√ß√µes Pessoais</h3>
                <textarea id="observacoesPessoais" rows="3" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;" 
                    placeholder="Adicione suas observa√ß√µes..." onblur="salvarObservacoes()"></textarea>
            </div>
        </div>
    </div>
    
    <!-- Modal de Novo/Editar Evento -->
    <div id="modalEvento" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3 style="margin-bottom: 24px;" id="modalEventoTitulo">Novo Evento</h3>
            <input type="hidden" id="eventoId">
            
            <div class="form-group">
                <label>Tipo de Evento <span style="color: #ef4444;">*</span></label>
                <select id="eventoTipo" onchange="atualizarCamposEvento()">
                    <option value="reuniao">üìÖ Reuni√£o</option>
                    <option value="entrega">üì¶ Entrega</option>
                    <option value="prazo">‚è∞ Prazo</option>
                    <option value="marco">üéØ Marco do Projeto</option>
                    <option value="outro">üìå Outro (visita, auditoria, etc)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>T√≠tulo <span style="color: #ef4444;">*</span></label>
                <input type="text" id="eventoTitulo" placeholder="Digite o t√≠tulo do evento" required>
                <span class="error-message hidden" id="eventoTituloError">T√≠tulo √© obrigat√≥rio</span>
            </div>
            
            <div class="form-group">
                <label>Descri√ß√£o</label>
                <textarea id="eventoDescricao" rows="3" placeholder="Adicione uma descri√ß√£o detalhada..."></textarea>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="eventoDiaCompleto" onchange="toggleHorarios()">
                    Evento de dia completo
                </label>
            </div>
            
            <div class="form-group">
                <label>Data <span style="color: #ef4444;">*</span></label>
                <input type="date" id="eventoData" required>
                <span class="error-message hidden" id="eventoDataError">Data √© obrigat√≥ria</span>
            </div>
            
            <div class="form-group" id="grupoDataFim" style="display: none;">
                <label>Data de T√©rmino</label>
                <input type="date" id="eventoDataFim">
                <small style="color: #6b7280;">Para eventos de m√∫ltiplos dias</small>
            </div>
            
            <div class="horario-group" id="grupoHorarios">
                <div class="form-group">
                    <label>Hor√°rio In√≠cio <span style="color: #ef4444;">*</span></label>
                    <input type="time" id="eventoHorarioInicio" value="09:00" required>
                    <span class="error-message hidden" id="eventoHorarioInicioError">Hor√°rio √© obrigat√≥rio</span>
                </div>
                <div class="form-group">
                    <label>Hor√°rio Fim</label>
                    <input type="time" id="eventoHorarioFim" value="10:00">
                </div>
            </div>
            
            <div class="form-group" id="grupoLocal">
                <label>Local</label>
                <input type="text" id="eventoLocal" placeholder="Ex: Sala de reuni√£o, Canteiro de obras...">
            </div>
            
            <div class="form-group">
                <label id="labelPessoas">Participantes</label>
                <select id="eventoPessoas" onchange="adicionarPessoa()">
                    <option value="">Selecionar pessoa...</option>
                </select>
                <div class="pessoas-selecionadas" id="pessoasSelecionadas"></div>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="eventoRecorrente" onchange="toggleRecorrencia()">
                    Evento recorrente
                </label>
            </div>
            
            <div class="recorrencia-config hidden" id="recorrenciaConfig">
                <div class="form-group">
                    <label>Tipo de Recorr√™ncia</label>
                    <select id="recorrenciaTipo" onchange="atualizarConfigRecorrencia()">
                        <option value="diaria">Di√°ria</option>
                        <option value="semanal">Semanal</option>
                        <option value="quinzenal">Quinzenal</option>
                        <option value="mensal">Mensal</option>
                        <option value="bimestral">Bimestral</option>
                        <option value="personalizada">Personalizada</option>
                    </select>
                </div>
                
                <div class="form-group hidden" id="grupoDiasSemana">
                    <label>Dias da Semana</label>
                    <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                        <label><input type="checkbox" value="0"> Domingo</label>
                        <label><input type="checkbox" value="1"> Segunda</label>
                        <label><input type="checkbox" value="2"> Ter√ßa</label>
                        <label><input type="checkbox" value="3"> Quarta</label>
                        <label><input type="checkbox" value="4"> Quinta</label>
                        <label><input type="checkbox" value="5"> Sexta</label>
                        <label><input type="checkbox" value="6"> S√°bado</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>At√© quando?</label>
                    <input type="date" id="recorrenciaFim">
                    <small style="color: #6b7280;">Deixe vazio para continuar indefinidamente</small>
                </div>
            </div>
            
            <div class="form-group">
                <label>Vincular a Tarefas</label>
                <button type="button" class="btn btn-secondary btn-sm" onclick="abrirSeletorTarefas()">
                    + Selecionar Tarefas
                </button>
                <div class="tarefas-vinculadas" id="tarefasVinculadas"></div>
            </div>
            
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModal('modalEvento')">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarEvento()" id="btnSalvarEvento">Salvar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Nova/Editar Atividade -->
    <div id="modalAtividade" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 24px;" id="modalAtividadeTitulo">Nova Atividade</h3>
            <input type="hidden" id="atividadeId">
            <div class="form-group">
                <label>Nome da Atividade <span style="color: #ef4444;">*</span></label>
                <input type="text" id="atividadeNome" placeholder="Digite o nome da atividade" required>
                <span class="error-message hidden" id="atividadeNomeError">Nome √© obrigat√≥rio</span>
            </div>
            <div class="form-group">
                <label>Prazo <span style="color: #ef4444;">*</span></label>
                <input type="date" id="atividadePrazo" required onchange="validarPrazoAtividade()">
                <span class="error-message hidden" id="atividadePrazoError">Prazo √© obrigat√≥rio</span>
                <span class="error-message hidden" id="atividadePrazoPassadoError">‚ö†Ô∏è Prazo n√£o pode ser no passado!</span>
            </div>
            <div class="form-group">
                <label>Respons√°veis <span style="color: #ef4444;">*</span></label>
                <select id="atividadeResponsaveis" multiple style="height: 100px;" required></select>
                <small style="color: #6b7280;">Segure Ctrl para selecionar m√∫ltiplos</small>
                <span class="error-message hidden" id="atividadeResponsaveisError">Selecione ao menos um respons√°vel</span>
            </div>
            <div class="form-group">
                <label>Status</label>
                <select id="atividadeStatus">
                    <option value="verde">üü¢ Em Dia</option>
                    <option value="amarelo">üü° Aten√ß√£o</option>
                    <option value="vermelho">üî¥ Atraso</option>
                </select>
            </div>
            <div class="form-group">
                <label>Progresso (%) <span class="tooltip" data-tooltip="Calculado automaticamente pelas tarefas">‚ÑπÔ∏è</span></label>
                <input type="number" id="atividadeProgresso" min="0" max="100" placeholder="Calculado automaticamente" readonly 
                       style="background: #f9fafb; cursor: not-allowed;">
                <small style="color: #6b7280;">O progresso √© calculado automaticamente baseado nas tarefas conclu√≠das</small>
            </div>
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModal('modalAtividade')">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarAtividade()" id="btnSalvarAtividade">Salvar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Nova Tarefa -->
    <div id="modalTarefa" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 24px;">Nova Tarefa Pessoal</h3>
            <div class="form-group">
                <label>Tipo de Agendamento</label>
                <select id="tarefaTipo" onchange="alternarTipoAgendamento()">
                    <option value="semanal">Dia da Semana</option>
                    <option value="data">Data Espec√≠fica</option>
                </select>
            </div>
            <div class="form-group" id="grupoDiaSemana">
                <label>Dia da Semana</label>
                <select id="tarefaDia">
                    <option value="segunda">Segunda-feira</option>
                    <option value="terca">Ter√ßa-feira</option>
                    <option value="quarta">Quarta-feira</option>
                    <option value="quinta">Quinta-feira</option>
                    <option value="sexta">Sexta-feira</option>
                </select>
            </div>
            <div class="form-group hidden" id="grupoData">
                <label>Data Espec√≠fica <span style="color: #ef4444;">*</span></label>
                <input type="date" id="tarefaDataEspecifica">
                <span class="error-message hidden" id="tarefaDataError">Data √© obrigat√≥ria</span>
            </div>
            <div class="form-group">
                <label>Descri√ß√£o <span style="color: #ef4444;">*</span></label>
                <input type="text" id="tarefaDescricao" placeholder="Digite a descri√ß√£o da tarefa" required>
                <span class="error-message hidden" id="tarefaDescricaoError">Descri√ß√£o √© obrigat√≥ria</span>
            </div>
            <div class="form-group">
                <label>Hor√°rio <span style="color: #ef4444;">*</span></label>
                <input type="time" id="tarefaHorario" required>
                <span class="error-message hidden" id="tarefaHorarioError">Hor√°rio √© obrigat√≥rio</span>
            </div>
            <div class="form-group">
                <label>Recorr√™ncia</label>
                <select id="tarefaRecorrencia">
                    <option value="unica">√önica vez</option>
                    <option value="diaria">Di√°ria</option>
                    <option value="semanal">Semanal</option>
                    <option value="quinzenal">Quinzenal</option>
                    <option value="mensal">Mensal</option>
                </select>
            </div>
            <div class="form-group">
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="tarefaCalendario">
                        üìÖ Mostrar no calend√°rio da equipe
                    </label>
                </div>
                <small style="color: #6b7280; font-size: 12px; display: block; margin-top: 4px;">
                    Marque para tarefas importantes que toda equipe deve ver
                </small>
            </div>
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModal('modalTarefa')">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarTarefa()" id="btnSalvarTarefa">Salvar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Editar Tarefa Individual -->
    <div id="modalEditarTarefa" class="modal">
        <div class="modal-content modal-editar-tarefa">
            <h3 style="margin-bottom: 24px;">‚úèÔ∏è Editar Tarefa</h3>
            <input type="hidden" id="editTarefaAtividadeId">
            <input type="hidden" id="editTarefaId">
            
            <div class="form-group">
                <label>Descri√ß√£o <span style="color: #ef4444;">*</span></label>
                <input type="text" id="editTarefaDescricao" placeholder="Digite a descri√ß√£o da tarefa" required>
                <span class="error-message hidden" id="editTarefaDescricaoError">Descri√ß√£o √© obrigat√≥ria</span>
            </div>
            
            <div class="form-group">
                <label>Prioridade</label>
                <select id="editTarefaPrioridade">
                    <option value="baixa">üü¢ Baixa</option>
                    <option value="media">üü° M√©dia</option>
                    <option value="alta">üî¥ Alta</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Respons√°vel</label>
                <select id="editTarefaResponsavel">
                    <!-- Ser√° preenchido dinamicamente -->
                </select>
            </div>
            
            <div class="form-group">
                <label>Prazo (opcional)</label>
                <input type="date" id="editTarefaPrazo">
            </div>
            
            <div class="form-group">
                <label>Depend√™ncias</label>
                <div id="editTarefaDependencias" style="max-height: 150px; overflow-y: auto; border: 1px solid #d1d5db; border-radius: 8px; padding: 12px;">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
                <small style="color: #6b7280;">Selecione tarefas que devem ser conclu√≠das antes desta</small>
            </div>
            
            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea id="editTarefaObservacoes" rows="3" placeholder="Adicione observa√ß√µes sobre a tarefa..."></textarea>
            </div>
            
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModal('modalEditarTarefa')">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarEdicaoTarefa()">Salvar Altera√ß√µes</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Marcar Status -->
    <div id="modalStatus" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 24px;">Marcar Status do Dia</h3>
            <div class="form-group">
                <label>Data <span style="color: #ef4444;">*</span></label>
                <input type="date" id="statusData" required>
                <span class="error-message hidden" id="statusDataError">Data √© obrigat√≥ria</span>
            </div>
            <div class="form-group">
                <label>Status</label>
                <select id="statusTipo">
                    <option value="presente">‚úÖ Presente</option>
                    <option value="ausencia">‚ùå Aus√™ncia</option>
                    <option value="home-office">üè† Home Office</option>
                </select>
            </div>
            <div class="form-group">
                <label>Observa√ß√£o (opcional)</label>
                <input type="text" id="statusObservacao" placeholder="Ex: Consulta m√©dica, reuni√£o externa...">
            </div>
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModal('modalStatus')">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarStatus()">Salvar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Marcar Feriado -->
    <div id="modalFeriado" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 24px;">Gerenciar Feriados</h3>
            <div class="form-group">
                <label>Data <span style="color: #ef4444;">*</span></label>
                <input type="date" id="feriadoData" required>
                <span class="error-message hidden" id="feriadoDataError">Data √© obrigat√≥ria</span>
            </div>
            <div class="form-group">
                <label>Nome do Feriado <span style="color: #ef4444;">*</span></label>
                <input type="text" id="feriadoNome" placeholder="Ex: Dia da Independ√™ncia" required>
                <span class="error-message hidden" id="feriadoNomeError">Nome √© obrigat√≥rio</span>
            </div>
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModal('modalFeriado')">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarFeriado()">Salvar</button>
            </div>
            
            <hr style="margin: 24px 0;">
            
            <h4 style="margin-bottom: 16px;">Feriados Cadastrados</h4>
            <div id="listaFeriados"></div>
        </div>
    </div>
    
    <!-- Modal de Importar -->
    <div id="modalImportar" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 24px;">Importar Dados</h3>
            <div class="form-group">
                <label>Selecione o arquivo JSON</label>
                <input type="file" id="importFile" accept=".json">
            </div>
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModal('modalImportar')">Cancelar</button>
                <button class="btn btn-primary" onclick="importarDados()">Importar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Sele√ß√£o de Tarefas -->
    <div id="modalSeletorTarefas" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <h3 style="margin-bottom: 24px;">Vincular Tarefas ao Evento</h3>
            <div class="form-group">
                <label>Buscar tarefas</label>
                <input type="text" id="buscarTarefaVinculo" placeholder="Digite para buscar..." onkeyup="filtrarTarefasVinculo()">
            </div>
            <div style="max-height: 400px; overflow-y: auto; margin: 20px 0;">
                <div id="listaTarefasVinculo"></div>
            </div>
            <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="fecharModalSeletorTarefas()">Fechar</button>
            </div>
        </div>
    </div>
    
    <!-- Firebase Scripts (CDN) - PRIMEIRO -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <!-- Configuration Scripts - SEGUNDO -->
    <script src="assets/js/config/constants.js"></script>
    <script src="assets/js/config/firebase.js"></script>
    
    <!-- DEPEND√äNCIAS CR√çTICAS - TERCEIRO -->
    <script>
        // ========== ESTADO GLOBAL INICIALIZA√á√ÉO ==========
        
        // Inicializar estado do sistema se n√£o existir
        if (typeof estadoSistema === 'undefined') {
            window.estadoSistema = {
                mesAtual: new Date().getMonth(),
                anoAtual: new Date().getFullYear(),
                areaAtual: null,
                pessoaAtual: null,
                filtroAtual: 'todos',
                editandoAtividade: null,
                editandoEvento: null,
                editandoTarefa: null,
                pessoasSelecionadas: new Set(),
                tarefasVinculadas: new Map(),
                versaoSistema: '5.1',
                usuarioEmail: null,
                usuarioNome: null,
                alertasPrazosExibidos: new Set()
            };
            console.log('‚úÖ Estado do sistema inicializado');
        }
        
        // Inicializar dados do sistema se n√£o existirem
        if (typeof dados === 'undefined') {
            window.dados = {
                versao: 5,
                areas: {
                    documentacao: {
                        nome: "Documenta√ß√£o & Arquivo",
                        coordenador: "Coordenador",
                        cor: "#8b5cf6",
                        equipe: [{nome: "Membro 1", cargo: "Cargo 1"}],
                        atividades: []
                    }
                },
                eventos: [],
                agendas: {},
                feriados: {},
                statusPessoal: {},
                historico: [],
                ultimaAtualizacao: new Date().toISOString()
            };
            console.log('‚úÖ Dados do sistema inicializados');
        }
        
        // ========== FUN√á√ïES AUXILIARES ESSENCIAIS ==========
        
        // Formatar data no padr√£o brasileiro
        if (typeof formatarData === 'undefined') {
            window.formatarData = function(data) {
                try {
                    const d = new Date(data);
                    return `${d.getDate().toString().padStart(2, '0')}/${(d.getMonth() + 1).toString().padStart(2, '0')}`;
                } catch (error) {
                    console.error('‚ùå Erro ao formatar data:', error);
                    return data;
                }
            };
        }
        
        // Calcular dias restantes
        if (typeof calcularDiasRestantes === 'undefined') {
            window.calcularDiasRestantes = function(prazo) {
                try {
                    const hoje = new Date();
                    hoje.setHours(0, 0, 0, 0);
                    const dataPrazo = new Date(prazo);
                    dataPrazo.setHours(0, 0, 0, 0);
                    return Math.floor((dataPrazo - hoje) / (1000 * 60 * 60 * 24));
                } catch (error) {
                    console.error('‚ùå Erro ao calcular dias restantes:', error);
                    return 0;
                }
            };
        }
        
        // Salvar dados (vers√£o b√°sica)
        if (typeof salvarDados === 'undefined') {
            window.salvarDados = function() {
                try {
                    console.log('üíæ Salvando dados...');
                    localStorage.setItem('sistemaGestaoBackup', JSON.stringify(dados));
                    
                    if (window.database && typeof usuarioAtual !== 'undefined' && usuarioAtual) {
                        dados.ultimaAtualizacao = new Date().toISOString();
                        window.database.ref('dados').set(dados)
                            .then(() => console.log('‚úÖ Dados salvos no Firebase'))
                            .catch(error => console.error('‚ùå Erro ao salvar no Firebase:', error));
                    }
                    return true;
                } catch (error) {
                    console.error('‚ùå Erro ao salvar dados:', error);
                    return false;
                }
            };
        }
        
        // Atualizar estat√≠sticas
        if (typeof atualizarEstatisticas === 'undefined') {
            window.atualizarEstatisticas = function() {
                try {
                    let totalVerde = 0, totalAmarelo = 0, totalVermelho = 0, totalEventos = 0;
                    
                    if (dados.areas) {
                        Object.values(dados.areas).forEach(area => {
                            if (area.atividades) {
                                area.atividades.forEach(atividade => {
                                    switch(atividade.status) {
                                        case 'verde': totalVerde++; break;
                                        case 'amarelo': totalAmarelo++; break;
                                        case 'vermelho': totalVermelho++; break;
                                    }
                                });
                            }
                        });
                    }
                    
                    if (dados.eventos) {
                        const hoje = new Date();
                        totalEventos = dados.eventos.filter(evento => {
                            const dataEvento = new Date(evento.data);
                            return dataEvento.getMonth() === hoje.getMonth() && dataEvento.getFullYear() === hoje.getFullYear();
                        }).length;
                    }
                    
                    const updates = [
                        { id: 'statEmDia', value: totalVerde },
                        { id: 'statAtencao', value: totalAmarelo },
                        { id: 'statAtraso', value: totalVermelho },
                        { id: 'statEventos', value: totalEventos }
                    ];
                    
                    updates.forEach(update => {
                        const element = document.getElementById(update.id);
                        if (element) element.textContent = update.value;
                    });
                    
                    console.log('‚úÖ Estat√≠sticas atualizadas');
                } catch (error) {
                    console.error('‚ùå Erro ao atualizar estat√≠sticas:', error);
                }
            };
        }
        
        // Fun√ß√µes auxiliares b√°sicas
        if (typeof marcarEditando === 'undefined') {
            window.marcarEditando = function(tipo, id) {
                console.log(`üìù Marcando como editando: ${tipo} ${id}`);
            };
        }
        
        if (typeof pararEditando === 'undefined') {
            window.pararEditando = function(tipo, id) {
                console.log(`‚úÖ Parando edi√ß√£o: ${tipo} ${id}`);
            };
        }
        
        // Sistema b√°sico de notifica√ß√µes
        if (typeof window.Notifications === 'undefined') {
            window.Notifications = {
                sucesso: function(msg) {
                    console.log('‚úÖ SUCESSO:', msg);
                    const notification = document.getElementById('notification');
                    if (notification) {
                        const text = document.getElementById('notificationText');
                        if (text) text.textContent = msg;
                        notification.className = 'notification active';
                        setTimeout(() => notification.classList.remove('active'), 3000);
                    }
                },
                erro: function(msg) {
                    console.error('‚ùå ERRO:', msg);
                    const notification = document.getElementById('notification');
                    if (notification) {
                        const text = document.getElementById('notificationText');
                        if (text) text.textContent = msg;
                        notification.className = 'notification error active';
                        setTimeout(() => notification.classList.remove('active'), 3000);
                    }
                }
            };
        }
        
        console.log('üîß Depend√™ncias cr√≠ticas carregadas');
    </script>
    
    <!-- Script tempor√°rio para resolver problemas imediatos -->
    <script>
        // Aguardar Firebase estar pronto
        document.addEventListener('firebaseReady', function() {
            console.log('üéâ Sistema pronto para uso!');
        });
        
        // Fun√ß√£o tempor√°ria para testar se tudo est√° funcionando
        function testarSistema() {
            console.group('üß™ TESTE DO SISTEMA');
            console.log('Firebase:', typeof firebase !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('Database:', !!window.database ? '‚úÖ' : '‚ùå');
            console.log('Auth:', !!window.auth ? '‚úÖ' : '‚ùå');
            console.log('Constants:', !!window.VERSAO_SISTEMA ? '‚úÖ' : '‚ùå');
            console.log('Estado Sistema:', !!window.estadoSistema ? '‚úÖ' : '‚ùå');
            console.log('Dados:', !!window.dados ? '‚úÖ' : '‚ùå');
            console.log('FormatarData:', typeof formatarData !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.groupEnd();
        }
        
        // Executar teste ap√≥s 3 segundos
        setTimeout(testarSistema, 3000);
    </script>
    
    <!-- Core Scripts -->
    <script src="assets/js/core/state.js"></script>
    <script src="assets/js/core/auth.js"></script>
    <script src="assets/js/core/sync.js"></script>
    <script src="assets/js/core/init.js"></script>
    <script src="assets/js/core/auto-org.js"></script>
    
    <!-- Utils Scripts -->
    <script src="assets/js/utils/helpers.js"></script>
    <script src="assets/js/utils/validators.js"></script>
    <script src="assets/js/utils/notifications.js"></script>
    <script src="assets/js/utils/dom.js"></script>
    <script src="assets/js/utils/functions-criticas.js"></script>
    
    <!-- Modules Scripts -->
    <script src="assets/js/modules/dashboard.js"></script>
    <script src="assets/js/modules/calendario.js"></script>
    <script src="assets/js/modules/atividades.js"></script>
    <script src="assets/js/modules/tarefas.js"></script>
    <script src="assets/js/modules/agenda.js"></script>
    <script src="assets/js/modules/relatorios.js"></script>
    <script src="assets/js/modules/diagnostico_sistema.js"></script>
    
    <!-- Main Application Script -->
    <script src="assets/js/app.js"></script>
    
    <!-- FUN√á√ïES TEMPOR√ÅRIAS PARA RESOLVER PROBLEMAS IMEDIATOS -->
    <script>
        // ========== FUN√á√ïES CR√çTICAS TEMPOR√ÅRIAS ==========
        // Para resolver o problema imediato das fun√ß√µes n√£o encontradas
        
        // Fun√ß√µes b√°sicas
        function fazerLogin() {
            console.log('‚ö†Ô∏è fazerLogin() tempor√°ria');
            alert('Sistema em migra√ß√£o - fazerLogin ser√° implementada');
        }
        
        function mostrarRegistro() {
            console.log('‚ö†Ô∏è mostrarRegistro() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarRegistro ser√° implementada');
        }
        
        function fecharModal(modalId) {
            console.log('‚ö†Ô∏è fecharModal() tempor√°ria para:', modalId);
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
            }
        }
        
        function toggleActivityLog() {
            console.log('‚ö†Ô∏è toggleActivityLog() tempor√°ria');
            const log = document.getElementById('activityLog');
            if (log) {
                log.classList.toggle('active');
            }
        }
        
        function resolverConflito(acao) {
            console.log('‚ö†Ô∏è resolverConflito() tempor√°ria:', acao);
            document.getElementById('conflictModal').classList.remove('active');
        }
        
        function exportarDados() {
            console.log('‚ö†Ô∏è exportarDados() tempor√°ria');
            alert('Sistema em migra√ß√£o - exportarDados ser√° implementada');
        }
        
        function mostrarImportar() {
            console.log('‚ö†Ô∏è mostrarImportar() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarImportar ser√° implementada');
        }
        
        function mostrarMarcarFeriado() {
            console.log('‚ö†Ô∏è mostrarMarcarFeriado() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarMarcarFeriado ser√° implementada');
        }
        
        function fazerLogout() {
            console.log('‚ö†Ô∏è fazerLogout() tempor√°ria');
            if (confirm('Deseja realmente sair?')) {
                alert('Sistema em migra√ß√£o - fazerLogout ser√° implementada');
            }
        }
        
        function mudarMes(direcao) {
            console.log('‚ö†Ô∏è mudarMes() tempor√°ria:', direcao);
            alert('Sistema em migra√ß√£o - mudarMes ser√° implementada');
        }
        
        function mostrarNovoEvento() {
            console.log('‚ö†Ô∏è mostrarNovoEvento() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarNovoEvento ser√° implementada');
        }
        
        function buscarGlobalDebounced() {
            console.log('‚ö†Ô∏è buscarGlobalDebounced() tempor√°ria');
        }
        
        function buscarGlobal() {
            console.log('‚ö†Ô∏è buscarGlobal() tempor√°ria');
            alert('Sistema em migra√ß√£o - buscarGlobal ser√° implementada');
        }
        
        function filtrarStatus(status, elemento) {
            console.log('‚ö†Ô∏è filtrarStatus() tempor√°ria:', status);
            document.querySelectorAll('.filter-pill').forEach(pill => {
                pill.classList.remove('active');
            });
            if (elemento) {
                elemento.classList.add('active');
            }
        }
        
        function voltarDashboard() {
            console.log('‚ö†Ô∏è voltarDashboard() tempor√°ria');
            alert('Sistema em migra√ß√£o - voltarDashboard ser√° implementada');
        }
        
        function mostrarNovaAtividade() {
            console.log('‚ö†Ô∏è mostrarNovaAtividade() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarNovaAtividade ser√° implementada');
        }
        
        function voltarParaArea() {
            console.log('‚ö†Ô∏è voltarParaArea() tempor√°ria');
            alert('Sistema em migra√ß√£o - voltarParaArea ser√° implementada');
        }
        
        function mostrarNovaTarefa() {
            console.log('‚ö†Ô∏è mostrarNovaTarefa() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarNovaTarefa ser√° implementada');
        }
        
        function mostrarMarcarStatus() {
            console.log('‚ö†Ô∏è mostrarMarcarStatus() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarMarcarStatus ser√° implementada');
        }
        
        function renderizarResponsabilidades(pessoa) {
            console.log('‚ö†Ô∏è renderizarResponsabilidades() tempor√°ria:', pessoa);
            alert('Sistema em migra√ß√£o - renderizarResponsabilidades ser√° implementada');
        }
        
        function mostrarAdicionarResponsabilidade() {
            console.log('‚ö†Ô∏è mostrarAdicionarResponsabilidade() tempor√°ria');
            alert('Sistema em migra√ß√£o - mostrarAdicionarResponsabilidade ser√° implementada');
        }
        
        function salvarObservacoes() {
            console.log('‚ö†Ô∏è salvarObservacoes() tempor√°ria');
            alert('Sistema em migra√ß√£o - salvarObservacoes ser√° implementada');
        }
        
        function atualizarCamposEvento() {
            console.log('‚ö†Ô∏è atualizarCamposEvento() tempor√°ria');
        }
        
        function toggleHorarios() {
            console.log('‚ö†Ô∏è toggleHorarios() tempor√°ria');
            const diaCompleto = document.getElementById('eventoDiaCompleto')?.checked;
            const grupoHorarios = document.getElementById('grupoHorarios');
            const grupoDataFim = document.getElementById('grupoDataFim');
            
            if (diaCompleto && grupoHorarios && grupoDataFim) {
                grupoHorarios.style.display = 'none';
                grupoDataFim.style.display = 'block';
            } else if (!diaCompleto && grupoHorarios && grupoDataFim) {
                grupoHorarios.style.display = 'grid';
                grupoDataFim.style.display = 'none';
            }
        }
        
        function adicionarPessoa() {
            console.log('‚ö†Ô∏è adicionarPessoa() tempor√°ria');
        }
        
        function toggleRecorrencia() {
            console.log('‚ö†Ô∏è toggleRecorrencia() tempor√°ria');
            const recorrente = document.getElementById('eventoRecorrente')?.checked;
            const config = document.getElementById('recorrenciaConfig');
            
            if (recorrente && config) {
                config.classList.remove('hidden');
            } else if (config) {
                config.classList.add('hidden');
            }
        }
        
        function atualizarConfigRecorrencia() {
            console.log('‚ö†Ô∏è atualizarConfigRecorrencia() tempor√°ria');
        }
        
        function abrirSeletorTarefas() {
            console.log('‚ö†Ô∏è abrirSeletorTarefas() tempor√°ria');
            const modal = document.getElementById('modalSeletorTarefas');
            if (modal) {
                modal.classList.add('active');
            }
        }
        
        function fecharModalSeletorTarefas() {
            console.log('‚ö†Ô∏è fecharModalSeletorTarefas() tempor√°ria');
            const modal = document.getElementById('modalSeletorTarefas');
            if (modal) {
                modal.classList.remove('active');
            }
        }
        
        function salvarEvento() {
            console.log('‚ö†Ô∏è salvarEvento() tempor√°ria');
            alert('Sistema em migra√ß√£o - salvarEvento ser√° implementada');
        }
        
        function validarPrazoAtividade() {
            console.log('‚ö†Ô∏è validarPrazoAtividade() tempor√°ria');
            return true; // Por enquanto sempre v√°lido
        }
        
        function salvarAtividade() {
            console.log('‚ö†Ô∏è salvarAtividade() tempor√°ria');
            alert('Sistema em migra√ß√£o - salvarAtividade ser√° implementada');
        }
        
        function alternarTipoAgendamento() {
            console.log('‚ö†Ô∏è alternarTipoAgendamento() tempor√°ria');
            const tipo = document.getElementById('tarefaTipo')?.value;
            const grupoDia = document.getElementById('grupoDiaSemana');
            const grupoData = document.getElementById('grupoData');
            
            if (tipo === 'semanal' && grupoDia && grupoData) {
                grupoDia.classList.remove('hidden');
                grupoData.classList.add('hidden');
            } else if (tipo === 'data' && grupoDia && grupoData) {
                grupoDia.classList.add('hidden');
                grupoData.classList.remove('hidden');
            }
        }
        
        function salvarTarefa() {
            console.log('‚ö†Ô∏è salvarTarefa() tempor√°ria');
            alert('Sistema em migra√ß√£o - salvarTarefa ser√° implementada');
        }
        
        function salvarEdicaoTarefa() {
            console.log('‚ö†Ô∏è salvarEdicaoTarefa() tempor√°ria');
            alert('Sistema em migra√ß√£o - salvarEdicaoTarefa ser√° implementada');
        }
        
        function salvarStatus() {
            console.log('‚ö†Ô∏è salvarStatus() tempor√°ria');
            alert('Sistema em migra√ß√£o - salvarStatus ser√° implementada');
        }
        
        function salvarFeriado() {
            console.log('‚ö†Ô∏è salvarFeriado() tempor√°ria');
            alert('Sistema em migra√ß√£o - salvarFeriado ser√° implementada');
        }
        
        function importarDados() {
            console.log('‚ö†Ô∏è importarDados() tempor√°ria');
            alert('Sistema em migra√ß√£o - importarDados ser√° implementada');
        }
        
        function filtrarTarefasVinculo() {
            console.log('‚ö†Ô∏è filtrarTarefasVinculo() tempor√°ria');
        }
        
        console.log('üîß Fun√ß√µes tempor√°rias carregadas - sistema funcionando temporariamente');
        console.log('‚ö†Ô∏è ATEN√á√ÉO: Migre as fun√ß√µes completas para os m√≥dulos correspondentes!');
        
        // ========== INICIALIZA√á√ÉO AUTOM√ÅTICA DO CALEND√ÅRIO ==========
        function aguardarEInicializarCalendario() {
            let tentativas = 0;
            const maxTentativas = 20;
            
            function tentar() {
                tentativas++;
                console.log(`üìÖ Tentativa ${tentativas}/${maxTentativas} de inicializar calend√°rio...`);
                
                const calendarioDisponivel = (
                    typeof window.calendarioFunctions !== 'undefined' &&
                    typeof window.calendarioFunctions.inicializarCalendario === 'function'
                );
                
                const dependenciasOK = (
                    typeof estadoSistema !== 'undefined' &&
                    typeof dados !== 'undefined' &&
                    document.getElementById('calendario') !== null
                );
                
                if (calendarioDisponivel && dependenciasOK) {
                    console.log('‚úÖ Calend√°rio e depend√™ncias prontos! Inicializando...');
                    
                    // Aguardar um pouco mais para garantir estabilidade
                    setTimeout(() => {
                        try {
                            const sucesso = window.calendarioFunctions.inicializarCalendario();
                            if (sucesso) {
                                console.log('üéâ Calend√°rio inicializado com sucesso!');
                                
                                // Atualizar estat√≠sticas
                                setTimeout(() => {
                                    if (typeof atualizarEstatisticas === 'function') {
                                        atualizarEstatisticas();
                                    }
                                }, 100);
                                
                                // Mostrar mensagem de sucesso
                                if (window.Notifications) {
                                    window.Notifications.sucesso('Sistema carregado com sucesso!');
                                }
                            } else {
                                console.warn('‚ö†Ô∏è Calend√°rio inicializado parcialmente');
                            }
                        } catch (error) {
                            console.error('‚ùå Erro ao inicializar calend√°rio:', error);
                        }
                    }, 100);
                    
                } else if (tentativas < maxTentativas) {
                    console.log('‚è≥ Aguardando calend√°rio ou depend√™ncias... tentando novamente em 200ms');
                    setTimeout(tentar, 200);
                } else {
                    console.warn('‚ö†Ô∏è Calend√°rio n√£o p√¥de ser inicializado automaticamente');
                    console.log('üìù Tentando inicializa√ß√£o b√°sica...');
                    
                    // Tentar inicializa√ß√£o b√°sica do calend√°rio
                    try {
                        const calendario = document.getElementById('calendario');
                        if (calendario && estadoSistema) {
                            calendario.innerHTML = '<div style="grid-column: span 7; text-align: center; padding: 40px; color: #6b7280;">üìÖ Calend√°rio em carregamento...</div>';
                            
                            // Atualizar t√≠tulo do m√™s
                            const meses = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
                            const mesAno = document.getElementById('mesAno');
                            if (mesAno) {
                                mesAno.textContent = `${meses[estadoSistema.mesAtual]} ${estadoSistema.anoAtual}`;
                            }
                            
                            console.log('üìÖ Calend√°rio b√°sico configurado');
                        }
                    } catch (error) {
                        console.error('‚ùå Erro na inicializa√ß√£o b√°sica:', error);
                    }
                }
            }
            
            // Iniciar tentativas
            tentar();
        }
        
        // Inicializar quando DOM estiver pronto
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(aguardarEInicializarCalendario, 500);
            });
        } else {
            setTimeout(aguardarEInicializarCalendario, 300);
        }
        
        // Inicializa√ß√£o adicional quando window carregar
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('üîÑ Verifica√ß√£o final do sistema...');
                
                // Verificar se calend√°rio ainda n√£o foi inicializado
                const calendario = document.getElementById('calendario');
                if (calendario && (!calendario.children.length || calendario.innerHTML.includes('carregamento'))) {
                    console.log('üîÑ Calend√°rio ainda n√£o carregado, tentando novamente...');
                    aguardarEInicializarCalendario();
                }
                
                // Atualizar estat√≠sticas se necess√°rio
                if (typeof atualizarEstatisticas === 'function') {
                    atualizarEstatisticas();
                }
            }, 1000);
        });
    </script>
</body>
</html>
